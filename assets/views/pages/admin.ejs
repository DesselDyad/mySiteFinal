<!DOCTYPE html>
<html>

<% include ../partials/head.ejs %>

<body>
    <% include ../partials/header.ejs %>
            <div class="row">
                    <div id="main" class="admin_main col-xs-10 col-xs-offset-1">
                        <div class="row">
                            <div class="col-xs-12">
                                <% if(typeof(update_user_body) != 'undefined') { %>
                                    <% if(update_user_body != null && update_user_body != undefined) { %> 
                                        <div id="edit_div" class="col-xs-12">
                                                <form id="user_form" method="post" action=<%= "/admin/updateUser/" + update_user_body.params_id%> enctype="multipart/form-data" novalidate>
                                                    <h1>Edit User </h1>
                                                    <div>
                                                        <label class="old_img_label" >Gammelt billede: </label>
                                                        <img src=<%= "/img/" + update_user_body.fileName%> alt="<%= update_user_body.fileName %>" title="<%= update_user_body.fileName %>" class="profile_img img-responsive">
                                                    </div>
                                                    <div>
                                                        <label class="profile_img_label" >Upload Nyt Billede</label>
                                                        <input type="file" name="userImage" id="userImage" value=<%= update_user_body.fileName %> >
                                                        <input type="text" name="oldImage" id="oldImage" value="<%= update_user_body.fileName %>"  class="hidden">
                                                        <img src="" id="preview" class="img-responsive hidden">
                                                    </div>
                                                    <div>
                                                        <label for="username">Username: </label>
                                                        <input name="username" type="text" id="username" value=<%= update_user_body.username %> minlength="5" maxlength="50" required>
                                                    </div>
                                                    <div>
                                                        <label for="name">Name: </label>
                                                        <input name="name" type="text" id="name" value=<%= update_user_body.name %>  minlength="5" maxlength="50" required autofocus>
                                                    </div>
                                                    <div>
                                                        <label for="email">E-mail Adress: </label>
                                                        <input name="email" type="text" id="email" value=<%= update_user_body.email %>  required>
                                                    </div>
                                                    <div>
                                                        <label for="email2">E-mail Adress: </label>
                                                        <input name="email2" type="text" id="email2" value=<%= update_user_body.email2 %>  required>
                                                    </div>
                                                    <div>
                                                        <label for="adress">Adress: </label>
                                                        <input name="adress" type="text" id="adress" value=<%= update_user_body.adress %>  minlength="5" maxlength="50">
                                                    </div>
                                                    <div>
                                                        <label for="phone">Phone number: </label>
                                                        <input name="phone" type="text" id="phone" value=<%= update_user_body.phone %>  min="5" max="11">
                                                    </div>
                                                    <div class="form-group">
                                                        <label>Change Signature</label>
                                                        <input type="text" class="form-control" placeholder="Change Signature" name="signature"  value=<%= add_user_body.signature %> required>
                                                    </div>
                                                    <div>
                                                        <label for="role">User Role: </label>
                                                        <select name="role" type="text" id="role" value=<%= update_user_body.role %>  min="5" max="11">
                                                            <% roles.forEach(role => { %>
                                                                <option value=<%= role.name %>>
                                                                    <%= role.name %>
                                                                </option>
                                                            <% }) %>
                                                        </select>
                                                    </div>
                                                        <button type="submit" id=<%= update_user_body.params_id %> >Update</button>
                                                </form>
                                        </div>
                                    <% } %>
                                <% } else { %>
                                    <div id="edit_div" class="col-xs-12 hidden">
                                        
                                    </div>
                                <% } %>
                            </div>
                            <h1 class="overview_h1">Overblik</h1>
                            <% include ../partials/locals_errors.ejs %>
                            <% include ../partials/form_errors.ejs %>
                            <button id="users_btn" class="btn_clicked">Brugere</button>
                            <button id="subscribers_btn">Subscribers</button>
                            <br>
                            <hr id="my_hr">
                            <div id="users_div" class="col-xs-12">
                                <div class="row">
                                        <form id="new_user_form" method="post" action="/admin/addUser" enctype="multipart/form-data" novalidate>
                                            <h1 id="add_user_h1" class="glyphicon glyphicon-chevron-down">Tilføj en ny Bruger </h1>
                                            <% if(typeof(add_user_body) != 'undefined') { %>
                                                <% if(add_user_body) { %>
                                                    <section class="add_user_section">
                                                        <hr>
                                                        <div class="form-group">
                                                            <label>Name</label>
                                                            <input type="text" class="form-control" placeholder="Name" name="name" value=<%= add_user_body.name %> required autofocus>
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Username</label>
                                                            <input type="text" class="form-control" placeholder="Username" name="username" value=<%= add_user_body.username %> required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Email</label>
                                                            <input type="email" class="form-control" placeholder="Email" name="email"  value=<%= add_user_body.email %> required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Confirm Email</label>
                                                            <input type="email" class="form-control" placeholder="Confirm Email" name="email2"  value=<%= add_user_body.email2 %> required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Adress</label>
                                                            <input type="text" class="form-control" placeholder="Adress" name="adress"  value=<%= add_user_body.adress %> required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Phone Number</label>
                                                            <input type="text" class="form-control" placeholder="Phone Number" name="phone"  value=<%= add_user_body.phone %> required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Password</label>
                                                            <input type="password" class="form-control" placeholder="Password" name="password" required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Confirm Password</label>
                                                            <input type="password" class="form-control" placeholder="Confirm Password" name="password2" required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Change Signature</label>
                                                            <input type="text" class="form-control" placeholder="Change Signature" name="signature"  value=<%= add_user_body.signature %> required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="role">User Role: </label>
                                                            <select name="role" type="text" id="role" placeholder="member" min="5" max="11">
                                                                <% roles.forEach(role => { %>
                                                                    <option value=<%= role.name %>>
                                                                        <%= role.name %>
                                                                    </option>
                                                                <% }) %>
                                                            </select>
                                                        </div>
                                                        <div class="form-group">
                                                            <label class="profile_img_label" >Upload Nyt Billede</label>
                                                            <input type="file" name="userImage" id="userImage">
                                                            <img src="" id="preview" class="img-responsive">
                                                        </div>
                                                        <button type="submit" class="btn btn-default">Submit</button>
                                                    </section>%>
                                                <% } else { %>
                                                    <section class="add_user_section hidden">
                                                        <hr>
                                                        <div class="form-group">
                                                            <label>Name</label>
                                                            <input type="text" class="form-control" placeholder="Name" name="name"  autofocus>
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Username</label>
                                                            <input type="text" class="form-control" placeholder="Username" name="username"  >
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Email</label>
                                                            <input type="email" class="form-control" placeholder="Email" name="email"  >
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Confirm Email</label>
                                                            <input type="email" class="form-control" placeholder="Confirm Email" name="email2"  >
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Adress</label>
                                                            <input type="text" class="form-control" placeholder="Adress" name="adress"  >
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Phone Number</label>
                                                            <input type="text" class="form-control" placeholder="Phone Number" name="phone"  >
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Password</label>
                                                            <input type="password" class="form-control" placeholder="Password" name="password"  >
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Confirm Password</label>
                                                            <input type="password" class="form-control" placeholder="Confirm Password" name="password2"  >
                                                        </div>
                                                        <div class="form-group">
                                                            <label>Change Signature</label>
                                                            <input type="text" class="form-control" placeholder="Change Signature" name="signature" required>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="role">User Role: </label>
                                                            <select name="role" type="text" id="role" placeholder="member" min="5" max="11">
                                                                <% roles.forEach(role => { %>
                                                                    <option value=<%= role.name %>>
                                                                        <%= role.name %>
                                                                    </option>
                                                                <% }) %>
                                                            </select>
                                                        </div>
                                                        <div class="form-group">
                                                            <label class="profile_img_label" >Upload Nyt Billede</label>
                                                            <input type="file" name="userImage" id="userImage">
                                                            <img src="" id="preview" class="img-responsive">
                                                        </div>
                                                        <button type="submit" class="btn btn-default">Submit</button>
                                                    </section>
                                                <% } %>
                                            <% } %>
                                        </form>
                                        <div class="table_wrapper" class="col-xs-12">
                                            <h2 id="users_title" class="glyphicon glyphicon-chevron-down">Brugere</h2>
                                            <table id="users_table" class="hidden">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            Operation
                                                        </th>
                                                        <th>
                                                            Image
                                                        </th>
                                                        <th>
                                                            Username
                                                        </th>
                                                        <th>
                                                            Name
                                                        </th>
                                                        <th>
                                                            Email
                                                        </th>
                                                        <th>
                                                            Adress
                                                        </th>
                                                        <th>
                                                            Phone number
                                                        </th>
                                                        <th>
                                                            Created Date
                                                        </th>
                                                        <th>
                                                            User Role
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <% users.forEach(user => { %>
                                                        <tr>
                                                            <td>
                                                                <button class="wrench glyphicon glyphicon-wrench" id=<%= user._id %> onclick="edit_user(this.id)"></button>
                                                                <button class="delete glyphicon glyphicon-remove" id=<%= user._id %> onclick="delete_user_admin(this.id)"></button>
                                                            </td>
                                                            <td>
                                                                <img src=<%='/img/' + user.local.profile_img %>>
                                                            </td>
                                                            <td>
                                                                <%= user.local.account.username %>
                                                            </td>
                                                            <td>
                                                                <%= user.local.contact_info.name %>
                                                            </td>
                                                            <td>
                                                                <%= user.local.contact_info.email %>
                                                            </td>
                                                            <td>
                                                                <%= user.local.contact_info.adress %>
                                                            </td>
                                                            <td>
                                                                <%= user.local.contact_info.phone %>
                                                            </td>
                                                            <td>
                                                                <%= user.local.created %>
                                                            </td>
                                                            <td>
                                                                <%= user.local.role %>
                                                            </td>
                                                        </tr>
                                                        <% }) %>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                            </div>
                            <div id="subscribers_div" class="col-xs-12 hidden">
                                <div class="row">
                                        <form id="new_subscriber_form" method="post" action="/newsletter/addSubscriber" novalidate>
                                            <h1 id="add_subscriber_h1" class="glyphicon glyphicon-chevron-down">Tilføj Subscriber </h1>
                                            <% if(typeof(add_subscriber_body) != 'undefined') { %>
                                                <% if(add_subscriber_body) { %>
                                                    <section class="add_subscriber_section">
                                                        <hr>
                                                        <p>
                                                            <label for="name">Name: </label>
                                                            <input name="name" type="text" id="name" placeholder="Navn" minlength="5" maxlength="50" value=<%= add_subscriber_body.name %> required autofocus>
                                                        </p>
                                                        <p>
                                                            <label for="email">E-mail Adress: </label>
                                                            <input name="email" type="text" id="email" placeholder="E-mail adresse" value=<%= add_subscriber_body.email %> required>
                                                        </p>
                                                        <button type="submit">Tilføj</button>
                                                    </section>
                                                <% } %>
                                            <% } else { %>
                                                <section class="add_subscriber_section hidden">
                                                    <hr>
                                                    <p>
                                                        <label for="name">Name: </label>
                                                        <input name="name" type="text" id="name" placeholder="Navn" minlength="5" maxlength="50" required autofocus>
                                                    </p>
                                                    <p>
                                                        <label for="email">E-mail Adress: </label>
                                                        <input name="email" type="text" id="email" placeholder="E-mail adresse" required>
                                                    </p>
                                                    <button type="submit">Tilføj</button>
                                                </section>
                                            <% } %>
                                        </form>
                                        <div class="table_wrapper" class="col-xs-12">
                                            <h2 id="subscribers_title" class="glyphicon glyphicon-chevron-down">Subscribers</h2>
                                            <table id="subscribers_table" class="hidden">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            Operation
                                                        </th>
                                                        <th>
                                                            Name
                                                        </th>
                                                        <th>
                                                            Email
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <% subscribers.forEach(subscriber => { %>
                                                        <tr>
                                                            <td>
                                                                <button class="delete glyphicon glyphicon-remove" id=<%= subscriber.id %> onclick="delete_subscriber(this.id)"></button>
                                                            </td>
                                                            <td>
                                                                <%= subscriber.name %>
                                                            </td>
                                                            <td>
                                                                <%= subscriber.email %>
                                                            </td>
                                                        </tr>
                                                        <% }) %>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                            </div>
                        </div>
                    </div>
        </div>
        <% include ../partials/footer.ejs %>
</body>

</html>